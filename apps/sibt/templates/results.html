{% extends "../../plugin/templates/vote.html" %}

{% block styles %}
    <style type="text/css">
        html. body {
            background: transparent !important;
            background-color: transparent !important;
        }
        h2 a {
            color: inherit;
            text-decoration: none;
        }
        h2 a:hover {
            text-decoration: underline;
        }
        #wrapper {
            margin-top: 130px;
        }
    </style>
{% endblock %}

{% block body_start %}
    <div id='header'>
        <div id="white"></div>
        <div id="cloud_bottom"></div>
        <div id="cloud_top"></div>
    </div>
{% endblock %}

{% block screens %}
    <div id="asker_title">
        <div id="title">
            {% if asker_pic %}
                <img align="left" src="{{ asker_pic }}"  />
            {% endif %}
            Should <b>{{asker_name}}</b> Buy This?
            <div id="share_again">
                Invite a friend to vote: <input style="width: 250px" type="text" readonly="readonly" value="{{ share_url }}" />
            </div>
        </div>
    </div>
    <div id="main_content" class="slight_highlight">
        <div id="product_screen">
            <div id="num_votes">
                {{ total_votes }} friends voted so far.
            </div>
            {% if vote_percentage %}
            <div id="percentage">
                {{ vote_percentage }}% say buy it!
            </div>
            {% endif %}
            <div id="time">
                <span>Voting ends</span>
                <abbr class="timeago" title="{{ instance_ends }}"></abbr>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            var yesses = {{yesses}};
            var noes = {{noes}};
            var is_asker = ('{{ is_asker }}' == 'True');
            var is_live = ('{{ is_live }}' == 'True');
            var title;
            $.timeago.settings.allowFuture = true;
            title = $('#title'); 

            if (!is_live) {
                title.html("Comments"); 
                $('abbr.timeago').prev('span').html('Voting ended ');
            } else if (is_asker) {
                title.html("");
            }

            $('iframe').load(function() {
                $(this).css('width', '100%'); 
            });
            $('abbr.timeago').timeago();
        });
    </script>
    <script>
        window.fbAsyncInit = function() {
            // see: http://stackoverflow.com/questions/7655352/facebook-comment-fbcomment-returning-https-content-when-called-over-http
            //FB._https = true;
            FB.init({
                appId: '{{FACEBOOK_APP_ID}}', // App ID
                //channelURL : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel File
                status: true, // check login status
                cookie: true, // enable cookies to allow the server to access the session
                oauth: true, // enable OAuth 2.0
                width: 400,
                xfbml: true  // parse XFBML
            });
        };

        var fbinit = function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement(s);
            js.id = id;
            js.async = true;
            js.src = "https://connect.facebook.net/en_US/all.js#xfbml=1";
            fjs.parentNode.insertBefore(js, fjs);
        };
    </script>
{% endblock %}

