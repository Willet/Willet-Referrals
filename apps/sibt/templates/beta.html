{% extends "../shopify/templates/base.html" %}

{% block head %}
    <style>
        input[type='text'], textarea {
            width: 75%;
            margin-bottom: 5px;
        }
        div button {
            position: relative;
            top: -1px;
        }
        #success_script .insert {
            font-family: Monaco, 'Courier New', 'Lucida Console', monospace;
            border: 1px #ddd solid;
            background-color: #f6f6f6;
            font-size: 1em;
            width:80%;
            height:500px;
            max-width:100%;
            max-height:100%;
            margin:auto;
            text-align: left;
            overflow: scroll;
        }
        #sibt_reg_form table td, #sibt_reg_form input {
            font-size: 1.1em;
        }
        #error_bar {
            color: #f20;
        }
    </style>
    <script type="text/javascript">
        $(document).ready(function () {
            var $form = $('#sibt_reg_form');
            if ($form.length > 0) {
                $form.submit(function (e) {
                    e.preventDefault();
                    $.ajax({
                        url: '{% url SIBTSignUp %}',
                        cache: false,
                        data: $(this).serialize(),
                        type: 'POST',
                        dataType: 'json',
                        success: function (data) {
                            $('#success_script .insert').html(
                                $('#success_script .insert').html()
                                    .replace("(client_uuid)", data.client_uuid)
                                    .replace("(app_uuid)", data.app_uuid)
                            );
                            $('#success_script').show();
                            $('#sibt_reg_form').slideUp('slow');
                        },
                        error: function (jqXHR) {
                            switch (jqXHR.status) {
                                case 400:
                                    $('#error_bar').html('Please ensure all of your information is correctly filled in.').slideDown();
                                    break;
                                case 500:
                                    $('#error_bar').html('The server could not process your request - please try again later.').slideDown();
                                    break;
                                default:
                                    $('#error_bar').html('An unknown error occurred!').slideDown();
                                    break;
                            }
                        }
                    });
                });
            }   
        });
    </script>
{% endblock head %}

{% block content %}

    <h1 class="span-24 last lower-100 center">Should I Buy This?</h1>
    
    <div class="span-8 append-1">
        <p class="span-8 lower-50">
            Lowering cart abandonment <strong>and</strong> gaining you <strong>new</strong>, <strong>better</strong> customers!
            <br /><br />
            Empower your customers to get shopping advice from their friends!
            <br /><br />
            Friends come to <strong>your site</strong>, discover your products, and help your initial customer make a decision!
            <br /><br />
            <b>100% free</b> for our Beta customers - <b>That's YOU</b>!
        </p>
    </div>

    <div class="span-15 last">
        <iframe style="border: 10px solid #474747; border-radius: 10px;" width="560" height="315" src="http://www.youtube.com/embed/VujD0OOZNvU" frameborder="0" allowfullscreen></iframe>
    </div>

    <div class="about prepend-top append-bottom span-24 last center">
        <form id='sibt_reg_form'>
            <h3>Interested? Sign up now!</h3>
            <br />
            <fieldset>
                <legend>Your information</legend>
                <table>
                    <tr>
                        <td style='width:50%'>Full name:</td>
                        <td><input type="text" name="fullname" placeholder="Full name" /></td>
                    </tr>
                    <tr>
                        <td>Email:</td>
                        <td><input type="text" name="email" placeholder="Admin email" /></td>
                    </tr>
                    <tr>
                        <td>Phone number (optional):</td>
                        <td><input type="text" name="phone" placeholder="Phone number (optional)" /></td>
                    </tr>
                    <tr>
                        <td>Address (optional):</td>
                        <td><input type="text" name="address1" placeholder="Address (optional)" /></td>
                    </tr>
                </table>
            </fieldset>
            
            <fieldset>
                <legend>Site information</legend>
                <table>
                    <tr>
                        <td style='width:50%'>Store name:</td>
                        <td><input type="text" name="shopname" placeholder="Shop name" value="Amy&rsquo;s Bakery" /></td>
                        <!-- ridiculous name here is to encourage real input -->
                    </tr>
                    <tr>
                        <td>Store URL:</td>
                        <td><input type="text" name="shop_url" placeholder="URL" value="http://amysbakery.com" />
                            <br />
                            The app will only work on this domain.
                        </td>
                    </tr>
                </table>
            </fieldset>
            
            <input class="button" type="submit" value="Done" />
            <div id='error_bar'></div>
        </form>
        <div id='success_script' style='display:none'>
            <h3>Congratulations!</h3>
            <p>All you need to do now is to paste this snippet into your web pages.</p>
            <pre class="insert">
&lt;div class=&quot;_willet_sibt&quot; 
     data-sibtversion=&quot;{{ sibt_version }}&quot;
     data-app_uuid=&quot;(app_uuid)&quot;
     data-client_uuid=&quot;(client_uuid)&quot;
     data-title=&quot; (name of your product) &quot;
     data-description=&quot; (product description) &quot;
     data-images=&quot; (optional: pictures of the product, separated by a comma) &quot;
     data-image=&quot; (optional: picture of the product) &quot;
     data-tags=&quot; (optional: tags for the product) &quot;
     data-price=&quot;19.00&quot;&gt;
&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;/*&lt;![CDATA[*//*----&gt;*/;!function (d, st) {
    &quot;use strict&quot;; try {
        var jse = d.getElementsByTagName(st)[0], jsa = d.createElement(st);
        jsa.src = '{{ URL }}{% url SIBTServeScript %}' + 
            '?url=' + encodeURIComponent(window.location.href); // required
        jse.parentNode.insertBefore(jsa, jse);
    } catch (e) {}
}(document, 'script');/*--*//*]]&gt;*/&lt;/script&gt;</pre>
            <!-- do not reindent lines above -->
        </div>
    </div>
{% endblock content %}
