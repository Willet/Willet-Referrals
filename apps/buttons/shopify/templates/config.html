{% extends "base.html" %}

{% block head %}
<style>
    .shopconnection-header {
        height: 62px;
        margin: 10px 0;
    }
    .shopconnection-header img {
        border: 1px solid #93BC8B;
        border-radius: 10px;
        width: 60px;
        height: 60px;
        float: left;
    }
    .shopconnection-header h3 {
        color: #0496AC;
        text-shadow: 1px 1px 1px #FFF;
        line-height: 2em;
        padding-left: 90px;
        margin: 0;
    }
    .box-design {
        background-color: #fff;
    }
    .box-design form, .box-design .preview {
        padding-top: 20px;
        padding-bottom: 20px;
        font-size: 1.5em;
    }

    #config-free {
        display: block;
    }

    .config-option, .submit {
        clear: both;
    }

    .config-option {
        display: block;
    }

    .left-column {
        display   : inline-block;
        text-align: right;
        width     : 200px;
    }

    input {
    }

    .buttons {
        height: 40px;
    }

    .buttons span {
        position: relative;
        top: -9px;
    }

    .buttons label.disabled {
        color: #aaa;
    }

    .submit {
        text-align: center;
    }

    #unused-buttons, #default-buttons {
        list-style-type: none;
        margin: 0;
        display: inline-block;
        height: 20px;
        padding: 2px 2px 4px 2px;
        min-width: 100px;
        border: 1px dashed #aaa;
    }

    #default-buttons li, #unused-buttons li {
        display: inline-block;
    }

    .icon span {
        display: none;
    }

    li.icon {
        padding: 1px;
    }

    span.icon {
        display: inline-block;
    }

    .icon {
        height: 20px;
        background-repeat: no-repeat;
        background-position-x: left;
        background-position-y: center;
        border: 0 none !important;
    }

    .icon.Facebook {
        background-image: url('/static/imgs/sb-config-facebook.png');
        width: 48px;
    }
    .icon.Facebook.buttonCount {
        background-image: url('/static/imgs/sb-config-facebook-count.png');
        width: 90px;
    }

    .icon.Twitter {
        background-image: url('/static/imgs/sb-config-twitter.png');
        width: 56px;
    }
    .icon.Twitter.buttonCount {
        background-image: url('/static/imgs/sb-config-twitter-count.png');
        width: 98px;
    }

    .icon.GooglePlus {
        background-image: url('/static/imgs/sb-config-googleplus.png');
        width: 32px;
    }
    .icon.GooglePlus.buttonCount {
        background-image: url('/static/imgs/sb-config-googleplus-count.png');
        width: 74px;
    }

    .icon.Svpply {
        background-image: url('/static/imgs/sb-config-svpply.png');
        width: 70px;
    }
    .icon.Svpply.buttonCount {
        background-image: url('/static/imgs/sb-config-svpply.png');
    }

    .icon.Fancy {
        background-image: url('/static/imgs/sb-config-fancy.png');
        width: 56px;
    }
    .icon.Fancy.buttonCount {
        background-image: url('/static/imgs/sb-config-fancy-count.png');
        width: 96px;
    }

    .icon.Pinterest {
        background-image: url('/static/imgs/sb-config-pinterest.png');
        width: 43px;
    }
    .icon.Pinterest.buttonCount {
        background-image: url('/static/imgs/sb-config-pinterest-count.png');
        width: 77px;
    }

    .icon.Tumblr {
        background-image: url('/static/imgs/sb-config-tumblr.png');
        width: 62px;
    }
    .icon.Tumblr.buttonCount {
        background-image: url('/static/imgs/sb-config-tumblr.png');
    }

    .preview {
        display: block;
        background-color: #ffa;
    }

    #buttons-preview {
        display: inline-block;
        border: 1px dotted #000;
        margin-left: 200px;
        margin-right: 20px;
    }
</style>
<!--[if IE 7]>
<style>
    .config-option .left-column {
        display   : inline-block;
        *display  : inline;
        zoom: 1;
    }

    #unused-buttons, #default-buttons {
        display: inline-block;
        *display  : inline;
        zoom: 1;
    }

    #default-buttons li, #unused-buttons li {
        display: inline-block;
        *display  : inline;
        zoom: 1;
    }

    .config-option .textbox {
        position: relative;
        top: 20px;
    }

    span.icon {
        display: inline-block;
        *display  : inline;
        zoom: 1;
    }

    #buttons-preview {
        display: inline-block;
        *display  : inline;
        zoom: 1;
    }
</style>
<script>
    $(document).ready(function(){
        $(".submit button").click(function(){
            $("form").submit();
        });
    });
</script>
<![endif]-->
<!--[if IE 8]>
<style>
    .buttons span {
        position: relative;
        top: -29px;
    }
</style>
<![endif]-->
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"
        type="text/javascript"></script>
<script src="/static/js/jquery.qtip-1.0.0-rc3.min.js"
        type="text/javascript"></script>
<script>
    $(document).ready(function(){
        var MAX_BUTTONS = 3,
            update_networks = function() {
                var networks = [],
                    network = "";
                $("#default-buttons > li").each(function(index, item){
                    network = $(item).text();
                    network = $.trim(network);
                    networks.push(network);
                });
                $("input[name='button_order']").val(networks.join(","));
            },
            update_preview = function(event) {
                var buttonsDiv = $('#buttons-preview'),
                    buttonsDivPadding = $("#button-padding").val() || 0;
                buttonsDiv.empty();

                $(buttonsDiv).css("padding", buttonsDivPadding + "px");

                $("#default-buttons > .icon").each(function(index, elem) {
                    var buttonClass = $(elem).attr("class"),
                        buttonCount = $("[name=button_count]:checked").val(),
                        buttonPadding = $("#button-spacing").val() || 0,
                        newImg;

                    newImg = $("<span/>", {
                        "class": buttonClass,
                        "border": 0
                    });
                    if (buttonCount === "True") {
                        $(newImg).addClass("buttonCount");
                    }

                    $(newImg).css("margin-right", buttonPadding + "px");

                    buttonsDiv.append(newImg);
                })
            };

        $("#default-buttons, #unused-buttons").sortable({
            connectWith: ".connectedSortable",
            update: function(event, ui) {
                update_networks();
                update_preview();
            },
            receive: function (event, ui) {
                if ($("#default-buttons > li").length > MAX_BUTTONS) {
                    $(ui.sender).sortable('cancel');
                    update_networks();
                }
            }
        }).disableSelection();

        $('.help[title]').qtip({
            content: {
                text: false
            },
            style: 'cream'
        });

        $("#button-padding").keyup(update_preview);
        $("#button-spacing").keyup(update_preview);

        $("[name=button_count]").change(update_preview);

        update_preview();

        $('#go_to_shopify').click(function() {
            window.location = "{{shop_url}}/admin";
        });
    });
</script>
{% endblock %}

{% block header-class %}tall{% endblock %}

{% block content %}
<div class="span-24 last shopconnection-header">
    <img src="/static/imgs/ShopConnection_icon_60x60.png" />
    <h3>{{ message }}</h3>
</div>

<div class="prepend-top span-24 last box-design content-container">
    <h1>ShopConnection Configuration</h1>

    <div class="prepend-top prepend-3 span-18 append-3 append-bottom last">
        <div class="box-design">
            <div class="preview">
                <span class="left-column">
                    <label for="buttons-preview">Preview:</label>
                </span>
                <span style="margin-right: 20px;">
                    See how your ShopConnection buttons
                    will appear in your store.
                </span>

                <span id="buttons-preview">
                </span>
            </div>
            <form method="POST" action="{{ action }}">
                <div id="config-free">
                    <div class="config-option buttons">
                        <span class="left-column">
                            <label for="default-buttons">
                                Default Buttons:
                            </label>
                            <img src="/static/imgs/info.png" alt="Help Icon"
                                 title="These buttons will be displayed by default
                                     when less than three networks are detected.<br/><br/>
                                     You are limited to selecting 3 buttons.<br/><br/>
                                     <i>Default: Pinterest, Tumblr, Fancy</i>"
                                 class="help">
                        </span>
                        <ul id="default-buttons" class="connectedSortable">
                            {% for button in button_order %}
                            <li class="icon {{ button }}">
                                <span>{{ button }}</span>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="config-option buttons">
                        <span class="left-column">
                            <label for="unused-buttons"
                                   class="disabled">
                                Available Buttons:
                            </label>
                        </span>
                        <ul id="unused-buttons" class="connectedSortable">
                            {% for button in unused_buttons %}
                            <li class="icon {{ button }}">
                                <span>{{ button }}</span>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="config-option" style="height: 40px;">
                        <span class="left-column">
                            <label for="button-count">
                                Show Button Count:
                            </label>
                            <img src="/static/imgs/info.png" alt="Help Icon"
                                 title="Determines whether or not a share count
                                 should appear next to the share button.<br/><br/>
                                 <i>Default: Hide</i>"
                                 class="help">
                        </span>
                        <input id="button-count" name="button_count"
                               type="radio"
                               value="True"
                               {% if button_count %}checked{% endif %}/>
                        <label for="button-count">Show</label>
                        <input id="no-button-count" name="button_count"
                               type="radio"
                               value="False"
                               {% if not button_count %}checked{% endif %}/>
                        <label for="no-button-count">Hide</label>
                    </div>
                    <div class="config-option">
                        <span class="left-column">
                            <label for="button-spacing">
                                Button Spacing:
                            </label>
                            <img src="/static/imgs/info.png" alt="Help Icon"
                                 title="Determines how much space, in pixels,
                                 should be put between the buttons.<br/><br/>
                                 <i>Default: 5px</i>"
                                 class="help">
                        </span>
                        <input id="button-spacing" name="button_spacing"
                               type="text" value="{{ button_spacing }}"
                               style="width: 50px;"
                               class="textbox"/>px
                    </div>
                    <div class="config-option">
                        <span class="left-column">
                            <label for="button-padding">
                                Container Padding:
                            </label>
                            <img src="/static/imgs/info.png" alt="Help Icon"
                                 title="Determines how much space, in pixels,
                                 should be around the button container.<br/><br/>

                                 <i>Default: 5px</i>"
                                 class="help">
                        </span>
                        <input id="button-padding" name="button_padding"
                               type="text" value="{{ button_padding }}"
                               style="width: 50px;"
                               class="textbox"/>px
                    </div>
                    <div class="config-option">
                        <span class="left-column">
                            <label for="sharing-message">
                                Sharing Message:
                            </label>
                            <img src="/static/imgs/info.png" alt="Help Icon"
                                 title="Determines what message will be displayed
                                 when sharing on Twitter or Pinterest.<br/><br/>

                                 <i>Default: I found this on {{shop_url}}</i>"
                                 class="help">
                        </span>
                        <input id="sharing-message" name="sharing_message"
                               type="text" value="{{ sharing_message }}"
                               class="textbox"/>
                    </div>
                </div>
                <div class="submit">
                    <input id="button-order" type="hidden" name="button_order"
                           value='{{ button_order|join:"," }}' />
                    <button class="blue">Save</button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="prepend-top prepend-3 span-18 append-3 last append-bottom">
    <h3 class="center">Have other questions? Email: fraser@getwillet.com</h3>
    <br />

    <div class="center">
        <button class='blue' id='go_to_shopify'>
            <img src="/static/imgs/shopify-bag-36.png" />
                <span style="float: right;display: block;padding-left: 10px;margin-top: 5%;">
                    Return to your Store
                </span>
        </button>
    </div>
</div>
{% endblock content %}